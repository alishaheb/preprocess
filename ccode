import pandas as pd
import re

# Load the CSV file
def split_mixed_columns(file_path):
    df = pd.read_csv(file_path)

    def split_mixed_values(value):
        if isinstance(value, str):
            match = re.findall(r'([a-zA-Z]+|\d+)', value)
            return match if match else [value]
        return [value]

    new_columns = {}

    for col in df.columns:
        split_data = df[col].astype(str).apply(split_mixed_values)
        max_parts = split_data.apply(len).max()

        if max_parts > 1:
            for i in range(max_parts):
                new_col_name = f"{col}_part{i+1}"
                new_columns[new_col_name] = split_data.apply(lambda x: x[i] if i < len(x) else '')
        else:
            new_columns[col] = df[col]

    new_df = pd.DataFrame(new_columns)
    new_df.to_csv("processed_output.csv", index=False)
    print("Processed CSV saved as 'processed_output.csv'")

# Run the function on the uploaded file
split_mixed_columns("/mnt/data/Hp treatment training.csv")
